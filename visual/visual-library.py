import pandas as pd
import numpy as np
import bar_chart_race as bcr

# Original data
data = {
    "The American Analog Set":["33","40","44","44","57","57","57","58","59","60","61","61","62","64","64",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Alex G":["27","38","38","38","38","38","38","38","38","38","49","104","105","107","109",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Moby":["21","23","25","25","25","25","25","26",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Idaho":["20","24","30","30","30","30","30","30","30","30",0,0,0,0,"33",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Modern Baseball":["11","15","22","24","24","25","25","35","38","38","40","40","41","46","46",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "American Football":["9","9",0,0,"22","33","33","36","36","36","39","39","39","44","44",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Adnan Sami":["7","7",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Kid Loco":["2",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "3l3d3p":["1",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Billy Joel":["1",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Modest Mouse":[0,"7","11","12",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Slater":[0,"5",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "The Garden":[0,"4","10",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Brian Green":[0,0,"14","14","14",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Playboi Carti":[0,0,"13","13",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Mac DeMarco":[0,0,"12","12","27","27","27","27","27","27",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Fontaines D.C.":[0,0,0,"36","37","37","37","54","57","57","57","57","61","66","68",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Boards of Canada":[0,0,0,0,"16","16","16",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Neutral Milk Hotel":[0,0,0,0,0,"30","30","30","30","30",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Origami Angel":[0,0,0,0,0,0,0,"22","47","47","50","50","50","54","68",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Mort Garson":[0,0,0,0,0,0,0,0,"28","47","47","47","47","47","47",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "The Magnetic Fields":[0,0,0,0,0,0,0,0,0,0,"41","41","41","42","42",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "Mom Jeans.":[0,0,0,0,0,0,0,0,0,0,"35","35","35","36","41",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    "sign crushes motorist":[0,0,0,0,0,0,0,0,0,0,"31","33","33","33",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
}

import pandas as pd
import numpy as np
import bar_chart_race as bcr

# --- CLEAN DATA ---
max_len = max(len(v) for v in data.values())

clean_data = {}

for artist, values in data.items():
    # Force numeric conversion safely
    numeric = pd.to_numeric(values, errors="coerce")
    numeric = numeric.astype(float)

    # Pad to equal length
    if len(numeric) < max_len:
        numeric = np.pad(numeric, (0, max_len - len(numeric)))

    clean_data[artist] = numeric

# --- CREATE DATAFRAME ---
df = pd.DataFrame(clean_data)

# Force full numeric matrix
df = df.astype(float)

# Add frame labels
df.index = range(1, len(df) + 1)
# --- BAR CHART RACE ---
bcr.bar_chart_race(
    df=df,
    filename='bar_race.gif',
    orientation='h',
    sort='desc',
    n_bars=10,
    fixed_order=False,
    fixed_max=True,
    steps_per_period=20,
    interpolate_period=True,
    period_length=800,
    title='Top 10 Artists per Time Frame',
    bar_size=.95,
    period_label={
        'x': .99,
        'y': .15,
        'ha': 'right',
        'va': 'center',
        'fontsize': 12
    },
    period_fmt='Frame {x}',
    figsize=(8, 5),
    cmap='tab20',
    filter_column_colors=True
)